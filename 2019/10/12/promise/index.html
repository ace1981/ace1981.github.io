<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>promise | Ace&#39;pages</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="https://www.jianshu.com/p/4a937870511d 12345678910111213let a=0;const promise =new Promise((resolve , reject) =&amp;gt; &amp;#123;    if(a === 0)&amp;#123;      	resolve(&apos;成功&apos;);    &amp;#125;    else&amp;#123;      	rejec">
<meta property="og:type" content="article">
<meta property="og:title" content="promise">
<meta property="og:url" content="http://hujao.com/2019/10/12/promise/index.html">
<meta property="og:site_name" content="Ace&#39;pages">
<meta property="og:description" content="https://www.jianshu.com/p/4a937870511d 12345678910111213let a=0;const promise =new Promise((resolve , reject) =&amp;gt; &amp;#123;    if(a === 0)&amp;#123;      	resolve(&apos;成功&apos;);    &amp;#125;    else&amp;#123;      	rejec">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-10-12T06:42:09.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="promise">
<meta name="twitter:description" content="https://www.jianshu.com/p/4a937870511d 12345678910111213let a=0;const promise =new Promise((resolve , reject) =&amp;gt; &amp;#123;    if(a === 0)&amp;#123;      	resolve(&apos;成功&apos;);    &amp;#125;    else&amp;#123;      	rejec">
  
    <link rel="alternate" href="/atom.xml" title="Ace&#39;pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>
</html>
  
    
      <body>
    
  
      <div id="container" class="container">
        <article id="post-promise" class="article article-type-post" itemscope="" itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/tags/docker">Docker</a>
    
      <a class="main-nav-link" href="/tags/springboot">SpringBoot</a>
    
      <a class="main-nav-link" href="/tags/elasticsearch">ElasticSearch</a>
    
      <a class="main-nav-link" href="/tags/test">Test</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      promise
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p><a href="https://www.jianshu.com/p/4a937870511d" target="_blank" rel="noopener">https://www.jianshu.com/p/4a937870511d</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> promise =<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve , reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(a === <span class="number">0</span>)&#123;</span><br><span class="line">      	resolve(<span class="string">'成功'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      	reject(<span class="string">'失败'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">promise.then(</span><br><span class="line">    (res) =&gt; &#123;<span class="built_in">console</span>.log(res)&#125;,  <span class="comment">// 成功</span></span><br><span class="line">    (err) =&gt; &#123;<span class="built_in">console</span>.log(err)&#125; <span class="comment">// 失败</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>这种“承诺将来会执行”的对象在JavaScript中称为Promise对象</p>
<h5 id="Promise含义"><a href="#Promise含义" class="headerlink" title="Promise含义"></a>Promise含义</h5><ul>
<li>promise是一种异步编程的解决方案</li>
<li>比传统的 回调函数和事件 更强大</li>
</ul>
<h5 id="Promise具体是什么？"><a href="#Promise具体是什么？" class="headerlink" title="Promise具体是什么？"></a>Promise具体是什么？</h5><ul>
<li>promise是一个容器，里面保存着某个未来才会结束的事件 (比如 异步操作的结果)</li>
<li>语法上：promise是一个对象，可以从它获取异步操作的消息</li>
<li>promise提供统一的api，所以各种异步操作都可以用同样的方法进行处理</li>
</ul>
<h5 id="Promise对象的特点？"><a href="#Promise对象的特点？" class="headerlink" title="Promise对象的特点？"></a>Promise对象的特点？</h5><ul>
<li>promise对象的状态不受外界影响 —– ( promise有三种状态 )<br>pending进行中，fulfilled已成功，rejected已失败<br>只有异步操作的结果可以决定当前是哪一种状态，其他别的操作无法改变这个状态</li>
<li>promise的状态一旦改变，就不会再变，任何时候都能得到这个结果<br>promise状态改变只有两种情况： <code>pending状态 变为 fulfilled状态</code>和<code>pending状态 变为 rejected状态</code><br>只要这两种情况发生，状态就凝固了，不会再改变，称为 ( resolved ) 已定型<br>例如：只要改变已经发生了，你再对promise对象添加回调函数，也会立即得到这个结果</li>
</ul>
<h5 id="Promise-vs-事件？"><a href="#Promise-vs-事件？" class="headerlink" title="Promise vs 事件？"></a>Promise vs 事件？</h5><ul>
<li><strong>Promise</strong>：只要改变已经发生了，你再对promise对象添加回调函数，也会立即得到这个结果</li>
<li><strong>event</strong>—-： 如果改变发生了，你再去监听，得不到结果</li>
</ul>
<h5 id="Promise对象-的优缺点？"><a href="#Promise对象-的优缺点？" class="headerlink" title="Promise对象 的优缺点？"></a>Promise对象 的优缺点？</h5><ul>
<li>优点<br>promise对象，可以将 <strong>异步操作</strong> 以 <strong>同步操作的流程</strong> 表达出来，避免层层嵌套</li>
<li>缺点<br>(1) promise一旦新建，就会立即执行，无法取消<br>(2) 如果不设置回掉函数，promise内部抛出的错误就不会反应到外部<br>(3) 处于pending状态时，是不能知道目前进展到哪个阶段的 ( 刚开始？，即将结束？)</li>
</ul>
<h5 id="Promise构造函数"><a href="#Promise构造函数" class="headerlink" title="Promise构造函数"></a>Promise构造函数</h5><p>es6规定，Promise对象 是一个构造函数，用来生成Promise实例</p>
<ul>
<li>Promise构造函数，接受一个函数作为参数，该函数有两个参数分别是 resolve 和<br>reject，它们是两个函数</li>
<li>resolve 和 reject 由 javascript 引擎提供，不用自己部署</li>
<li>resolve函数<br>resolve函数的作用是，将Promise对象的状态，由pending=&gt;变为fulfilled，在异步操作成功时调用，并将异步操作的结果，作为参数传递出去</li>
<li>reject函数<br>reject函数的作用是，将Promise对象的状态，由pending=&gt;变为rejected，在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      resolve(<span class="string">'hello'</span>)</span><br><span class="line">    &#125;, <span class="number">2000</span>)</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(val) <span class="comment">//  参数val = 'hello'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">'world'</span>)</span><br><span class="line">      &#125;, <span class="number">2000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(val) <span class="comment">// 参数val = 'world'</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount() &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">loadImage</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> image = <span class="keyword">new</span> Image(<span class="string">'400'</span>, <span class="string">'200'</span>)   <span class="comment">// 生成image实例对象，宽高</span></span><br><span class="line">                image.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    resolve(image)               <span class="comment">// 加载成功时候，返回image对象</span></span><br><span class="line">                &#125;</span><br><span class="line">                image.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    reject( <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`could not load image at <span class="subst">$&#123;url&#125;</span>`</span>))   <span class="comment">// 加载失败是报错</span></span><br><span class="line">                &#125;</span><br><span class="line">                image.src = url   <span class="comment">// 请求的图片地址</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        loadImage(<span class="string">'http://pic.7y7.com/201410/2014102458431393_600x0.jpg'</span>)</span><br><span class="line">            .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log( res.src )   <span class="comment">// 拿到image对象的src 属性</span></span><br><span class="line">                <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                    images: res</span><br><span class="line">                &#125;,() =&gt; &#123;<span class="built_in">console</span>.log(<span class="keyword">this</span>.state.images)&#125;)</span><br><span class="line">            &#125;,  () =&gt; &#123;</span><br><span class="line">                    <span class="comment">// rejected状态下的回掉函数</span></span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2019/10/12/promise/" class="article-date">
  <time datetime="2019-10-12T05:04:23.000Z" itemprop="datePublished">2019-10-12</time>
</a>

        </li>
        
        
        <hr>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2019/11/27/cesium/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          cesium
        
      </div>
    </a>
  
  
    <a href="/2019/09/28/ngroute/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Angular路由学习</div>
    </a>
  
</nav>


  
</article>




      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr>
      <div id="footerContent" class="footer-content">
        <p>闲步山雨后,静待晚林风 Post</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
