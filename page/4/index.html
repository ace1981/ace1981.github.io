<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Ace&#39;pages">
<meta property="og:url" content="http://hujao.com/page/4/index.html">
<meta property="og:site_name" content="Ace&#39;pages">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ace&#39;pages">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://hujao.com/page/4/"/>





  <title>Ace'pages</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ace'pages</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/05/11/threadexcuter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/11/threadexcuter/" itemprop="url">threadexcuter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-11T08:35:20+08:00">
                2018-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.cnblogs.com/wxgblogs/p/5469208.html" target="_blank" rel="noopener">https://www.cnblogs.com/wxgblogs/p/5469208.html</a></p>
<p><strong>1.Executor</strong></p>
<p>　　Executor是用来执行提交的Runnable任务的对象，并以接口的形式定义，提供一种提交任务(submission task）与执行任务(run task)之间的解耦方式，还包含有线程使用与周期调度的详细细节等。Executor常常用来代替早期的线程创建方式，如new Thread(new(RunnableTask())).start(),在实际中可以用如下的方式来提交任务到线程池里，Executor会自动执行 你的任务.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Executor executor = anExecutor;  </span><br><span class="line">executor.execute(<span class="keyword">new</span> RunnableTask1());</span><br></pre></td></tr></table></figure>
<p>　　Executor接口中定义的方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 在接下来的某个时刻执行提交的command任务。由于Executor不同的实现，执行的时候可能在一个新线程中或由一个线程池里的线程执行，还可以是由调用者线程执行*/</span>  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span></span>;</span><br></pre></td></tr></table></figure>
<p><strong>2.ExecutorService</strong></p>
<p>　　ExecutorService接口扩展了Executor,提供管理线程池终止的一组方法，还提供了产生Future的方法，Future是用于追踪一个或多个异步任务的对象，并能返回异步任务的计算结果。</p>
<p>　　ExecutorService关闭后将不再接收新的任务，ExecutorService提供了两种不同类型的关闭方法，<strong>shutdown方法允许执行完之前提交的任务才终止，而shutdownNow将不再执行等待的任务，并试图终止当前执行的任务</strong>。ExecutorService终止后，内部已没有活动的任务，没有等待的任务，也不能再提交新任务，没有使用ExecutorService需要回收相应的资源。</p>
<p>　　submit方法是基于Executor.execute()方法之上的，通过创建并返回一个Future对象就可以实现取消执行或者等待执行完成。invokeAny和invokeAll通常是用于批量执行，可以提交一个task集合并等待task的逐个完成。</p>
<p>　　ExecutorService接口中定义的方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//不再接收新的task,执行完之前提交的task后，开始有序的终止线程。 </span></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>;  </span><br><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment"> 试图终止所有活动的执行任务，停止对等待任务的处理，并返回待执行的Runnable列表。 </span></span><br><span class="line"><span class="comment"> 但是，不能保证能够终止掉所有的正在执行的任务。比如，在典型的实现中会调用Thread.interupt来作取消，但是一些不能响应中断的task将永远不会被终止 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="function">List&lt;Runnable&gt; <span class="title">shutdownNow</span><span class="params">()</span></span>;  </span><br><span class="line"> <span class="comment">//如果Executor调用shutdown或者shutdownNow将返回true</span></span><br><span class="line"> <span class="function"><span class="keyword">boolean</span> <span class="title">isShutdown</span><span class="params">()</span></span>; </span><br><span class="line"> <span class="comment">//所有的任务都关闭后，线程池才会关闭成功。届时返回true</span></span><br><span class="line"> <span class="function"><span class="keyword">boolean</span> <span class="title">isTerminated</span><span class="params">()</span></span>; </span><br><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment"> 发起关闭请求后，将一直阻塞等待关闭，直到所有的task已执行完成。 </span></span><br><span class="line"><span class="comment"> 如果超时返回，或者当前线程中断时， 则返回false </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="function"><span class="keyword">boolean</span> <span class="title">awaitTermination</span><span class="params">(<span class="keyword">long</span> timeout, TimeUnit unit)</span> <span class="keyword">throws</span> InterruptedException</span>;  </span><br><span class="line"> <span class="comment">//提交一个等待返回值的task,返回的Future表示task执行后的待定结果。执行成功后，Future的get方法将返回实际的结果。</span></span><br><span class="line"> &lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Callable&lt;T&gt; task)</span></span>;  </span><br><span class="line"> &lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Runnable task, T result)</span></span>;  </span><br><span class="line"> <span class="comment">//提交一个Runnable任务并返回一个Future。不过Future.get方法将返回null </span></span><br><span class="line"> Future&lt;?&gt; submit(Runnable task);  </span><br><span class="line"> <span class="comment">// 执行提交的task集合。当执行完成后，返回task各自的Future。对应返回的Future集合，Future.isDone方法将返回true </span></span><br><span class="line"> &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt;tasks)<span class="keyword">throws</span> InterruptedException;   </span><br><span class="line"> <span class="comment">//执行提交的task集合，返回一个task成功执行后的结果,而其他没有执行完成的task将被取消 </span></span><br><span class="line">&lt;T&gt; <span class="function">T <span class="title">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span><span class="keyword">throws</span> InterruptedException, ExecutionException</span>;</span><br></pre></td></tr></table></figure>
<p><strong>3. ThreadPoolExecutor</strong></p>
<p>　　ThreadPoolExecutor使用线程池里的线程来执行每个提交的task,一般通过Executors的工厂方法来创建并配置相应的参数。</p>
<p>　　线程池处理了两个问题：1.改善了性能。当执行大量的异步任务时，减少了每次调用的开销。2.提供了一直资源管理的方式。线程池内部的线程可以得到有效的复用。每个ThreadPoolExecutor内部还维护了一些基础的统计量，如完成的任务总数.ThreadPoolExecutor在很多场景下都有其用武之地，它提供了很多可调整的参数与可扩展的钩子方法。一般建议用Executors提供的便利的工厂方法来创建相应的ThreadPoolExecutor。如可以创建无限多线程newCachedThreadPool方法，创建固定大小的newFixedThreadPool方法，还有创建单个后台线程newSingleThreadExecutor的方法。这些预定义的方法能满足大 分的使用场景，然而当需要手动配置与调整线程池时，则需要知晓内部的究竟。</p>
<p>　　Ø 核心线程池大小(corePoolSize)与最大线程池大小(maximumPoolSize)</p>
<p>　　ThreadPoolExecutor会自动调节池子里线程的大小。通过execute方法提交新任务时，如果当前的池子里线程的大小小于核心线程 corePoolSize时，则会创建新线程来处理新的请求，即使当前的工作者线程是空闲的。如果运行的线程数是大于corePoolSize但小于 maximumPoolSize，而且当任务队列已经满了时，则会创建新线程。通过设置corePoolSize等于maximumPoolSize，便 可以创建固定大小的线程池数量。而设置maximumPoolSize为一个不受限制的数量如Integer.MAX，便可以创建一个适应任意数量大的并发任务的线程池。常规情况下，可以根据构造方法来设置corePoolSize与maximumPoolSize，但也可以通过 setCorePoolSize和setMaximumPoolSize方法动态的修改其值。</p>
<p>　　Ø 按需构造</p>
<p>　　<strong>默认情况下，核心线程是在开始接收新任务时才初始创建，但是可以使用prestartCoreThread或prestartAllCoreThreads方法来动态的预开启所有的线程数。</strong></p>
<p>　　Ø  创建新线程</p>
<p>　　新线程是使用java.util.concurrent.ThreadFactory来创建的，如果没有指定其他的方式，则是使用Executors.defaultThreadFactory方法，默认创建的线程拥有相同线程组与优先级且都是非后台线程。</p>
<p>　　Ø  存活时间（Keep-alive times）</p>
<p>　　若当前池里的线程数量超过corePoolSize，超出的线程如果是空闲的，将在存活指定的keepAliveTime时间后终止。这种机制主要是为减少资源的消耗，如果后期有新的活动任务，则又构造新的线程。该参数也可以通过setKeepAliveTime方法动态的修改，如果该参数设置为 Long.MAX_VALUE，则空闲的线程将一直存活。</p>
<p>　　Ø  阻塞队列</p>
<p>　　超出一定数量的任务会转移队列中，队列与池里的线程大小的关联表现在：如运行的线程数小于corePoolSize线程数，Executor会优先添加线程来执行task,而不会添加到队列中。如运行的线程已大于 corePoolSize,Executor会把新的任务放于队列中，如队列已到最大时，ThreadPoolExecutor会继续创建线程，直到超过 maximumPoolSize。最后，线程超过maximumPoolSize时，Executor将拒绝接收新的task.</p>
<p>　　而添加任务到队列时，有三种常规的策略：</p>
<p>1.直接传递。SynchronousQueue队列的默认方式，一个存储元素的阻塞队列而是直接投递到线程中。每一个入队操作必须等到另一个线程调用移除操作，否则入队将一直阻塞。当处理一些可能有内部依赖的任务时，这种策略避免了加锁操作。直接传递一般不能限制maximumPoolSizes以避免拒绝 接收新的任务。如果新增任务的速度大于任务处理的速度就会造成增加无限多的线程的可能性。</p>
<p>2.无界队列。如LinkedBlockingQueue，当核心线程正在工作时，使用不用预先定义大小的无界队列将使新到来的任务处理等到中，所以如果线程数是小于corePoolSize时，将不会创建有入队操作。这种策略将很适合那些相互独立的任务，如Web服务器。如果新增任务的速度大于任务处理的速度就会造成无界队列一直增长的可能性。</p>
<p>3.有界队列。如ArrayBlockingQueue，当定义了maximumPoolSizes时使用有界队列可以预防资源的耗尽，但是增加了调整和控制队列的难度，队列的大小和线程池的大小是相互影响的，使用很大的队列和较小的线程池会减少CPU消耗、操作系统资源以及线程上下文开销，但却人为的降低了吞吐量。如果任务是频繁阻塞型的（I/O），系统是可以把时间片分给多个线程的。而采用较小的队列和较大的线程池，虽会造成CPU繁忙，但却会遇到调度开销，这也会降低吞吐量。</p>
<p>　　Ø  饱和策略（拒绝接收任务）</p>
<p>　　当Executor调用shutdown方法后或者达到工作队列的最容量时,线程池则已经饱和了，此时则不会接收新的task。但无论是何种情 况，execute方法会调用RejectedExecutionHandler#rejectedExecution方法来执行饱和策略，在线程池内部预定义了几种处理策略：</p>
<ol>
<li>终止执行(AbortPolicy)。默认策略， Executor会抛出一个RejectedExecutionException运行异常到调用者线程来完成终止。</li>
<li>调用者线程来运行任务(CallerRunsPolicy)。这种策略会由调用execute方法的线程自身来执行任务，它提供了一个简单的反馈机制并能降低新任务的提交频率。</li>
<li>丢弃策略(DiscardPolicy)。不处理，直接丢弃提交的任务。</li>
<li>丢弃队列里最近的一个任务(DiscardOldestPolicy)。如果Executor还未shutdown的话，则丢弃工作队列的最近的一个任务，然后执行当前任务。</li>
</ol>
<p>　　终于可以走近代码了，在ThreadPoolExecutor，我们直接跳跃到核心的字段和方法处。</p>
<p>　　ThreadPoolExecutor类分析：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> 一 个ThreadPoolExecutor管理着一系列控制字段。首先需要保证在加锁的区域中， 执行的控制字段才能被改变，这些字段包含有 runState，poolSize, corePoolSize, and maximumPoolSize。然后这些字段被声明为volatile类 型，因此保证了内存可见性(任何线程都有对其的内存可见性)。 </span></span><br><span class="line"><span class="comment"> 而一些其他的字段是表示用户控制的参数，不会影响执行的结果，也声明为volatile类型，允许用户在执行时异步的改变。这些字段有包含有：allowCoreThreadTimeOut, keepAliveTime。除此之外，内部的饱和策略处理器、线程工厂也不会在加锁区域内被更 改。 </span></span><br><span class="line"><span class="comment">大量的volatile类型声明主要是保证在不用加锁的条件下，很多操作的结果都具有内存的可见性，如工作队列的任务入队和出队操作。 </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">runState提供生命周期的控制，有如下值： </span></span><br><span class="line"><span class="comment">RUNNING: 接收新任务并正在队列中的任务 </span></span><br><span class="line"><span class="comment">SHUTDOWN: 不再接收新的任务，但是仍在处理队列中的任务 </span></span><br><span class="line"><span class="comment">STOP：不再接收新的任务，不再处理队列中的任务并中断正在执行的任务 </span></span><br><span class="line"><span class="comment"> TERMINATED：同STOP一样，同时所有的线程已被终止 </span></span><br><span class="line"><span class="comment"> runState会单一的增加，但不需要每个值都命中，他们可有如下的转换顺序： </span></span><br><span class="line"><span class="comment"> RUNNING -&gt; SHUTDOWN 调用shutdown方法后 </span></span><br><span class="line"><span class="comment"> (RUNNING or SHUTDOWN) -&gt; STOP 调用shutdownNow()后 </span></span><br><span class="line"><span class="comment"> SHUTDOWN -&gt; TERMINATED 队列和线程池里的任务已完，线程已终止 </span></span><br><span class="line"><span class="comment"> STOP -&gt; TERMINATED 线程池已空，线程已终止 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="keyword">volatile</span> <span class="keyword">int</span> runState;  </span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RUNNING= <span class="number">0</span>;  </span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SHUTDOWN= <span class="number">1</span>;  </span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STOP = <span class="number">2</span>;  </span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TERMINATED = <span class="number">3</span>; </span><br><span class="line"> <span class="comment">//用于存储任务并把任务投递给工作者线程的阻塞队列。我们不需用workQueue.poll()方法返回null,因为此时可认为队列已为空，因此有时候必须再作检查</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> BlockingQueue&lt;Runnable&gt; workQueue; </span><br><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment"> 更新poolSize, corePoolSize, maximumPoolSize, runState, and workers者线程的锁 </span></span><br><span class="line"><span class="comment"> 在1.6中是一把重入锁，在1.7时已经修改为直接继承AQS。 </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock mainLock = <span class="keyword">new</span> ReentrantLock();  </span><br><span class="line"> <span class="comment">//用于辅助awaitTermination方法的等待条件 </span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> Condition termination = mainLock.newCondition();  </span><br><span class="line"> <span class="comment">//池里的工作者线程，当持有mainLock时才能读取  </span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> HashSet&lt;Worker&gt; workers = <span class="keyword">new</span> HashSet&lt;Worker&gt;();  </span><br><span class="line"> <span class="comment">// 以纳秒为单位的超时时间，如果allowCoreThreadTimeOut设置为true,则空闲的多余corePoolSize的线程将会在存活keepAliveTime时长后终止。</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">long</span>  keepAliveTime;  </span><br><span class="line"> <span class="comment">// 默认为false, 保留空闲的核心线程 </span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> allowCoreThreadTimeOut;  </span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">int</span>   corePoolSize;  </span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">int</span>   maximumPoolSize;  </span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">int</span>   poolSize;   </span><br><span class="line"> <span class="comment">//饱和执行策略或者shutdown后拒绝执行的策略  </span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> RejectedExecutionHandler handler;  </span><br><span class="line"> <span class="comment">//创建新线程的工厂。 </span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">volatile</span> ThreadFactory threadFactory;</span><br></pre></td></tr></table></figure>
<p>　　接下来便是一组按需指定的构造方法</p>
<p>　　分析一下最重要的execute方法。</p>
<ol>
<li><p>如果当前池里运行的线程数量小于corePoolSize,则创建新线程（需要获取全局锁）</p>
</li>
<li><p>如果当前的线程数量大于corePoolSize，则将任务加入BlockQueue中。</p>
</li>
<li><p>如果队列已满，但是线程数小于最大线程数量，则继续添加线程（需要再次获取全局锁）</p>
</li>
<li><p>已达到最大线程数量，任务队列也已经满了，任务将被拒绝，并调用RejectExecutionHanlder的rejectExecution方法。<br>ThreadPoolExecutor采用上述步骤的总体思路为，在执行execute方法时，尽可能的避免获取全局锁（影响性能），在<br>　   ThreadPoolExecutor完成核心线程的开启后，几乎所有的execute方法都是执行步骤2，巧妙地是，步骤2不需要获取全局锁。</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (command == <span class="keyword">null</span>) <span class="comment">//不能是空任务  </span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();  </span><br><span class="line">    <span class="comment">//如果还没有达到corePoolSize，则添加新线程来执行任务  </span></span><br><span class="line">        <span class="keyword">if</span> (poolSize &gt;= corePoolSize || !addIfUnderCorePoolSize(command)) &#123;  </span><br><span class="line">         <span class="comment">//如果已经达到corePoolSize,则不断的向工作队列中添加任务  </span></span><br><span class="line">            <span class="keyword">if</span> (runState == RUNNING &amp;&amp; workQueue.offer(command)) &#123;  </span><br><span class="line">            <span class="comment">//线程池已经没有任务  </span></span><br><span class="line">                <span class="keyword">if</span> (runState != RUNNING || poolSize == <span class="number">0</span>)   </span><br><span class="line">                     ensureQueuedTaskHandled(command);  </span><br><span class="line">             &#125;  </span><br><span class="line">          <span class="comment">//如果线程池不处于运行中或者工作队列已经满了，但是当前的线程数量还小于允许最大的maximumPoolSize线程数量，则继续创建线程来执行任务  </span></span><br><span class="line">             <span class="keyword">else</span> <span class="keyword">if</span> (!addIfUnderMaximumPoolSize(command))  </span><br><span class="line">             <span class="comment">//已达到最大线程数量，任务队列也已经满了，则调用饱和策略执行处理器  </span></span><br><span class="line">                 reject(command); <span class="comment">// is shutdown or saturated  </span></span><br><span class="line">         &#125;  </span><br><span class="line"> &#125;  </span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">addIfUnderCorePoolSize</span><span class="params">(Runnable firstTask)</span> </span>&#123;  </span><br><span class="line">         Thread t = <span class="keyword">null</span>;  </span><br><span class="line">         <span class="keyword">final</span> ReentrantLock mainLock = <span class="keyword">this</span>.mainLock;  </span><br><span class="line">         mainLock.lock();  </span><br><span class="line">         <span class="comment">//更改几个重要的控制字段需要加锁  </span></span><br><span class="line">         <span class="keyword">try</span> &#123;  </span><br><span class="line">             <span class="comment">//池里线程数量小于核心线程数量，并且还需要是运行时  </span></span><br><span class="line">             <span class="keyword">if</span> (poolSize &lt; corePoolSize &amp;&amp; runState == RUNNING)  </span><br><span class="line">                 t = addThread(firstTask);  </span><br><span class="line">         &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">             mainLock.unlock();  </span><br><span class="line">         &#125;  </span><br><span class="line">         <span class="keyword">if</span> (t == <span class="keyword">null</span>)  </span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">false</span>;  </span><br><span class="line">         t.start(); <span class="comment">//创建后，立即执行该任务  </span></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;  </span><br><span class="line">     &#125;  </span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">private</span> Thread <span class="title">addThread</span><span class="params">(Runnable firstTask)</span> </span>&#123;  </span><br><span class="line">         Worker w = <span class="keyword">new</span> Worker(firstTask);  </span><br><span class="line">         Thread t = threadFactory.newThread(w); <span class="comment">//委托线程工厂来创建，具有相同的组、优先级、都是非后台线程  </span></span><br><span class="line">         <span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;  </span><br><span class="line">             w.thread = t;  </span><br><span class="line">             workers.add(w); <span class="comment">//加入到工作者线程集合里  </span></span><br><span class="line">             <span class="keyword">int</span> nt = ++poolSize;  </span><br><span class="line">             <span class="keyword">if</span> (nt &gt; largestPoolSize)  </span><br><span class="line">                 largestPoolSize = nt;  </span><br><span class="line">         &#125;  </span><br><span class="line">         <span class="keyword">return</span> t;  </span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<p>　　再看看工作者线程的设计。</p>
<p>　　线程池内部可以直接用一个线程集合来复用线程，但Doug先生用Worker再次封装一下，估计其设计的初衷有：划分职责，只做单纯的任务消费者，执行完成后可追寻一些统计量。Worker执行任务时，需要先获取runLock，此处的目的是在任务的执行过程中防止worker线程被中断。然后双重检查是否线程池已停止或者中断。最好开始执行任务，此时调用用户自定的钩子方法，可在执行前和执行后作相应的处理。在Worker自身的run方法体中，需要先获取任务，调用实际的runTask。在获取任务的操作中，由于是阻塞获取，则保证了线程的最终存活的可能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">	<span class="keyword">try</span> &#123;  </span><br><span class="line">		Runnable task = firstTask;  </span><br><span class="line">		firstTask = <span class="keyword">null</span>;  </span><br><span class="line">         <span class="keyword">while</span> (task != <span class="keyword">null</span> || (task = getTask()) != <span class="keyword">null</span>) &#123; </span><br><span class="line">		<span class="comment">//调用阻塞获取任务的方法，如果没有则会一直阻塞于此，处理等待状态  </span></span><br><span class="line">                    runTask(task);  </span><br><span class="line">                    task = <span class="keyword">null</span>;  </span><br><span class="line">         &#125;  </span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">         workerDone(<span class="keyword">this</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最好看看从队列中获取任务的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Runnable <span class="title">getTask</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;  </span><br><span class="line">       <span class="keyword">try</span> &#123;  </span><br><span class="line">           <span class="keyword">int</span> state = runState;  </span><br><span class="line">           <span class="keyword">if</span> (state &gt; SHUTDOWN)  </span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">null</span>;  </span><br><span class="line">           Runnable r;  </span><br><span class="line">           <span class="keyword">if</span> (state == SHUTDOWN)  <span class="comment">// Help drain queue  </span></span><br><span class="line">               r = workQueue.poll(); <span class="comment">//poll方法不会阻塞  </span></span><br><span class="line">        <span class="comment">//keepAliveTime的超时终止体现在此处，超时后poll方法会返回r.然后回到worker的run方法里，由于没有可用的任务，超时返回的r会为null,因此worker的run方法会直接退出循环和导致线程结束。  </span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (poolSize &gt; corePoolSize || allowCoreThreadTimeOut)  </span><br><span class="line">                r = workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS);  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">                r = workQueue.take(); <span class="comment">//阻塞等待  </span></span><br><span class="line">            <span class="keyword">if</span> (r != <span class="keyword">null</span>)  </span><br><span class="line">                <span class="keyword">return</span> r;  </span><br><span class="line">            <span class="keyword">if</span> (workerCanExit()) &#123;  </span><br><span class="line">                <span class="keyword">if</span> (runState &gt;= SHUTDOWN) <span class="comment">// Wake up others  </span></span><br><span class="line">                    interruptIdleWorkers();  </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="comment">// Else retry  </span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;  </span><br><span class="line">            <span class="comment">// On interruption, re-check runState  </span></span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至于此，ThreadPoolExecutor的核心源码已经分析完成。</p>
<h2 id="二、再回头来分析原理"><a href="#二、再回头来分析原理" class="headerlink" title="二、再回头来分析原理"></a>二、再回头来分析原理</h2><p>执行示意图</p>
<p><img src="/2018/05/11/threadexcuter/20160221172500424.png" alt="img"></p>
<h2 id="三、线程池的使用"><a href="#三、线程池的使用" class="headerlink" title="三、线程池的使用"></a>三、线程池的使用</h2><ol>
<li>通过构造方法来初始化</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> maximumPoolSize,                                						  <span class="keyword">long</span> keepAliveTime,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          TimeUnit unit,  </span></span></span><br><span class="line"><span class="function"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue)</span></span></span><br></pre></td></tr></table></figure>
<ol>
<li>或使用Executors的工厂方法</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,                                        									<span class="number">0L</span>, TimeUnit.MILLISECONDS,  </span><br><span class="line">                                    <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,  </span><br><span class="line">                                     <span class="number">60L</span>, TimeUnit.SECONDS,  </span><br><span class="line">                                     <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());  </span><br><span class="line"></span><br><span class="line">executorPool.execute(<span class="keyword">new</span> TaskAction(taskId));</span><br></pre></td></tr></table></figure>
<ol>
<li>​</li>
</ol>
<h2 id="四、之前的一些疑惑"><a href="#四、之前的一些疑惑" class="headerlink" title="　四、之前的一些疑惑"></a>　四、之前的一些疑惑</h2><p>　　初步接触线程池时，有些问题也一直得不到解答，看完源码后，便得到了一下解答。</p>
<p>　　1. 线程为什么能够一直存活？</p>
<p>　　每个Woker是一个Runnable，同时会绑定到一个线程上。在执行Worker的run方法时，会去队列中获取任务，但是获取任务是阻塞的获取，如果没有则线程会一直等待，因此不会被终止。最终还是会转移到重入锁上并有内部同步器来完成执行阻塞的操作。</p>
<p>　　2. 参数keepAliveTime的具体原理？</p>
<p>　　在ThreadPoolExecutor的getTask方法中，如果当前池里线程的数量大于核心数量或者设置 allowCoreThreadTimeOut为true的话，则调用的是阻塞队列的 poll(long timeout,TimeUnit unit)方法，该方法等待指定的时间后会直接返回。worker线程会获取到返回的任务，如果为空的话，则退出循环，因此线程便结束了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/05/11/maven-plugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/11/maven-plugin/" itemprop="url">maven-plugin</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-11T08:34:57+08:00">
                2018-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/05/02/spring-data-redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/02/spring-data-redis/" itemprop="url">spring-data-redis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-02T01:51:04+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.cnblogs.com/yanan7890/p/6617305.html" target="_blank" rel="noopener">https://www.cnblogs.com/yanan7890/p/6617305.html</a></p>
<h1 id="redis五大类型用法"><a href="#redis五大类型用法" class="headerlink" title="redis五大类型用法"></a><a href="http://www.cnblogs.com/yanan7890/p/6617305.html" target="_blank" rel="noopener">redis五大类型用法</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Redis五大类型:字符串（String）、哈希/散列/字典（Hash）、列表（List）、集合（Set）、有序集合（sorted set）五种</span><br><span class="line">Controller:@Resource RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">总括:</span><br><span class="line">redisTemplate.opsForValue();//操作字符串</span><br><span class="line">redisTemplate.opsForHash();//操作hash</span><br><span class="line">redisTemplate.opsForList();//操作list</span><br><span class="line">redisTemplate.opsForSet();//操作set</span><br><span class="line">redisTemplate.opsForZSet();//操作有序set</span><br><span class="line"></span><br><span class="line">String:</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.redisTemplate.opsForValue().set(key,value)); </span><br><span class="line">2.redisTemplate.opsForValue().get(key)); </span><br><span class="line">3.redisTemplate.opsForValue().get(key, start, end);</span><br><span class="line">4.redisTemplate.opsForValue().getAndSet(key, value);</span><br><span class="line">5.redisTemplate.opsForValue().getBit(key, offset);//下方注释</span><br><span class="line">6.redisTemplate.opsForValue().multiGet(keys);</span><br><span class="line">7.redisTemplate.opsForValue().setBit(key, offset, value);//下方注释</span><br><span class="line">8.redisTemplate.opsForValue().set(K key, V value, long timeout, TimeUnit unit);//TimeUnit是timeout的类型,如毫秒\秒\天等</span><br><span class="line">9.redisTemplate.opsForValue().setIfAbsent(key, value);</span><br><span class="line">10.redisTemplate.opsForValue().set(K key, V value, long offset);//博主此处未做java验证</span><br><span class="line">11.redisTemplate.opsForValue().size(key));</span><br><span class="line">12.redisTemplate.opsForValue().multiGet(Collection&lt;K&gt; keys);</span><br><span class="line">13.redisTemplate.opsForValue().multiSetIfAbsent(Map&lt;? extends K, ? extends V&gt; m);</span><br><span class="line">14.同8</span><br><span class="line">15\16\17\18\19.redisTemplate.opsForValue().increment(K key, long delta);或.increment(K key, double delta);</span><br><span class="line">20.redisTemplate.opsForValue().append(key, value);//在key键对应值的右面追加值value</span><br><span class="line">可以看到并没有删除等方法,博主研究了一下可以这样:21.del key------21.redisTemplate.opsForValue().getOperations().delete(key);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>编号</th>
<th>命令</th>
<th>描述说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="http://www.yiibai.com/redis/strings_set.html" target="_blank" rel="noopener">SET key value</a></td>
<td>此命令设置指定键的值。</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://www.yiibai.com/redis/strings_get.html" target="_blank" rel="noopener">GET key</a></td>
<td>获取指定键的值。</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://www.yiibai.com/redis/strings_getrange.html" target="_blank" rel="noopener">GETRANGE key start end</a></td>
<td>获取存储在键上的字符串的子字符串。</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://www.yiibai.com/redis/strings_getset.html" target="_blank" rel="noopener">GETSET key value</a></td>
<td>设置键的字符串值并返回其旧值。</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://www.yiibai.com/redis/strings_getbit.html" target="_blank" rel="noopener">GETBIT key offset</a></td>
<td>返回在键处存储的字符串值中偏移处的位值。</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://www.yiibai.com/redis/strings_mget.html" target="_blank" rel="noopener">MGET key1 [key2..]</a></td>
<td>获取所有给定键的值</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://www.yiibai.com/redis/strings_setbit.html" target="_blank" rel="noopener">SETBIT key offset value</a></td>
<td>存储在键上的字符串值中设置或清除偏移处的位</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://www.yiibai.com/redis/strings_setex.html" target="_blank" rel="noopener">SETEX key seconds value</a></td>
<td>使用键和到期时间来设置值</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://www.yiibai.com/redis/strings_setnx.html" target="_blank" rel="noopener">SETNX key value</a></td>
<td>设置键的值，仅当键不存在时</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://www.yiibai.com/redis/strings_setrange.html" target="_blank" rel="noopener">SETRANGE key offset value</a></td>
<td>在指定偏移处开始的键处覆盖字符串的一部分</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://www.yiibai.com/redis/strings_strlen.html" target="_blank" rel="noopener">STRLEN key</a></td>
<td>获取存储在键中的值的长度</td>
</tr>
<tr>
<td>12</td>
<td><a href="http://www.yiibai.com/redis/strings_mset.html" target="_blank" rel="noopener">MSET key value [key value …]</a></td>
<td>为多个键分别设置它们的值</td>
</tr>
<tr>
<td>13</td>
<td><a href="http://www.yiibai.com/redis/strings_msetnx.html" target="_blank" rel="noopener">MSETNX key value [key value …]</a></td>
<td>为多个键分别设置它们的值，仅当键不存在时</td>
</tr>
<tr>
<td>14</td>
<td><a href="http://www.yiibai.com/redis/strings_psetex.html" target="_blank" rel="noopener">PSETEX key milliseconds value</a></td>
<td>设置键的值和到期时间(以毫秒为单位)</td>
</tr>
<tr>
<td>15</td>
<td><a href="http://www.yiibai.com/redis/strings_incr.html" target="_blank" rel="noopener">INCR key</a></td>
<td>将键的整数值增加<code>1</code></td>
</tr>
<tr>
<td>16</td>
<td><a href="http://www.yiibai.com/redis/strings_incrby.html" target="_blank" rel="noopener">INCRBY key increment</a></td>
<td>将键的整数值按给定的数值增加</td>
</tr>
<tr>
<td>17</td>
<td><a href="http://www.yiibai.com/redis/strings_incrbyfloat.html" target="_blank" rel="noopener">INCRBYFLOAT key increment</a></td>
<td>将键的浮点值按给定的数值增加</td>
</tr>
<tr>
<td>18</td>
<td><a href="http://www.yiibai.com/redis/strings_decr.html" target="_blank" rel="noopener">DECR key</a></td>
<td>将键的整数值减<code>1</code></td>
</tr>
<tr>
<td>19</td>
<td><a href="http://www.yiibai.com/redis/strings_decrby.html" target="_blank" rel="noopener">DECRBY key decrement</a></td>
<td>按给定数值减少键的整数值</td>
</tr>
<tr>
<td>20</td>
<td><a href="http://www.yiibai.com/redis/strings_append.html" target="_blank" rel="noopener">APPEND key value</a></td>
<td>将指定值附加到键</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.setBit(key, offset, value):key键对应的值value对应的ascii码,在offset的位置(从左向右数)变为value.(此处感谢@参考文章对我理解的帮助),由于二进制只有0和1,此处value只能取0和1,如图,其他值是超出范围的</span><br><span class="line">.getBit(key, offset):获取键对应值的ascii码的在offset处位值.</span><br><span class="line">@ascii码对照表</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hash:</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.redisTemplate.opsForHash().delete(H key, Object... hashKeys);//...表示可以传入多个map的key，用，隔开。或用数组传值</span><br><span class="line">2.redisTemplate.opsForHash().hasKey(key, hashKey)；</span><br><span class="line">3.redisTemplate.opsForHash().get(key, hashKey)；</span><br><span class="line">4.redisTemplate.opsForHash().entries(key);//返回map集合</span><br><span class="line">5、6.redisTemplate.opsForHash().increment(H key, HK hashKey, long delta);//或increment(H key, HK hashKey, double delta);；</span><br><span class="line">7.redisTemplate.opsForHash().keys(key)；//返回map的key集合Set</span><br><span class="line">8.redisTemplate.opsForHash().size(key)；</span><br><span class="line">9.redisTemplate.opsForHash().multiGet(H key, Collection&lt;HK&gt; hashKeys);</span><br><span class="line">10.redisTemplate.opsForHash().putAll(H key, Map&lt;? extends HK, ? extends HV&gt; m)；</span><br><span class="line">11.redisTemplate.opsForHash().put(key, hashKey, value);</span><br><span class="line">12.redisTemplate.opsForHash().putIfAbsent(key, hashKey, value)；</span><br><span class="line">13.redisTemplate.opsForHash().values(key);//返回map中的value集合List；</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="http://www.yiibai.com/redis/hashes_hdel.html" target="_blank" rel="noopener">HDEL key field2 [field2]</a></td>
<td>删除一个或多个哈希字段。</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://www.yiibai.com/redis/hashes_hexists.html" target="_blank" rel="noopener">HEXISTS key field</a></td>
<td>判断是否存在散列字段。</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://www.yiibai.com/redis/hashes_hget.html" target="_blank" rel="noopener">HGET key field</a></td>
<td>获取存储在指定键的哈希字段的值。</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://www.yiibai.com/redis/hashes_hgetall.html" target="_blank" rel="noopener">HGETALL key</a></td>
<td>获取存储在指定键的哈希中的所有字段和值</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://www.yiibai.com/redis/hashes_hincrby.html" target="_blank" rel="noopener">HINCRBY key field increment</a></td>
<td>将哈希字段的整数值按给定数字增加</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://www.yiibai.com/redis/hashes_hincrbyfloat.html" target="_blank" rel="noopener">HINCRBYFLOAT key field increment</a></td>
<td>将哈希字段的浮点值按给定数值增加</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://www.yiibai.com/redis/hashes_hkeys.html" target="_blank" rel="noopener">HKEYS key</a></td>
<td>获取哈希中的所有字段</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://www.yiibai.com/redis/hashes_hlen.html" target="_blank" rel="noopener">HLEN key</a></td>
<td>获取散列中的字段数量</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://www.yiibai.com/redis/hashes_hmget.html" target="_blank" rel="noopener">HMGET key field1 [field2]</a></td>
<td>获取所有给定哈希字段的值</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://www.yiibai.com/redis/hashes_hmset.html" target="_blank" rel="noopener">HMSET key field1 value1 [field2 value2 ]</a></td>
<td>为多个哈希字段分别设置它们的值</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://www.yiibai.com/redis/hashes_hset.html" target="_blank" rel="noopener">HSET key field value</a></td>
<td>设置散列字段的字符串值</td>
</tr>
<tr>
<td>12</td>
<td><a href="http://www.yiibai.com/redis/hashes_hsetnx.html" target="_blank" rel="noopener">HSETNX key field value</a></td>
<td>仅当字段不存在时，才设置散列字段的值</td>
</tr>
<tr>
<td>13</td>
<td><a href="http://www.yiibai.com/redis/hashes_hvals.html" target="_blank" rel="noopener">HVALS key</a></td>
<td>获取哈希中的所有值</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List：</span><br><span class="line"></span><br><span class="line">redisTemplate.opsForList().leftPush(key, value);//从左向右存压栈</span><br><span class="line">redisTemplate.opsForList().leftPop(key);//从左出栈</span><br><span class="line">redisTemplate.opsForList().size(key);//队/栈长</span><br><span class="line">redisTemplate.opsForList().range(key, start, end);//范围检索,返回List</span><br><span class="line">redisTemplate.opsForList().remove(key, i, value);//移除key中值为value的i个,返回删除的个数；如果没有这个元素则返回0 </span><br><span class="line">redisTemplate.opsForList().index(key, index);//检索</span><br><span class="line">redisTemplate.opsForList().set(key, index, value);//赋值</span><br><span class="line">redisTemplate.opsForList().trim(key, start, end);//裁剪,void,删除除了[start,end]以外的所有元素  </span><br><span class="line">redisTemplate.opsForList().rightPopAndLeftPush(String sourceKey, String destinationKey);//将源key的队列的右边的一个值删除，然后塞入目标key的队列的左边，返回这个值</span><br><span class="line">注意:要缓存的对象必须实现Serializable接口,因为 Spring 会将对象先序列化再存入 Redis,否则报异常nested exception is java.lang.IllegalArgumentException: DefaultSerializer requires a Serializable……//；；/</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="http://www.yiibai.com/redis/lists_blpop.html" target="_blank" rel="noopener">BLPOP key1 [key2 ] timeout</a></td>
<td>删除并获取列表中的第一个元素，或阻塞，直到有一个元素可用</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://www.yiibai.com/redis/lists_brpop.html" target="_blank" rel="noopener">BRPOP key1 [key2 ] timeout</a></td>
<td>删除并获取列表中的最后一个元素，或阻塞，直到有一个元素可用</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://www.yiibai.com/redis/lists_brpoplpush.html" target="_blank" rel="noopener">BRPOPLPUSH source destination timeout</a></td>
<td>从列表中弹出值，将其推送到另一个列表并返回它; 或阻塞，直到一个可用</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://www.yiibai.com/redis/lists_lindex.html" target="_blank" rel="noopener">LINDEX key index</a></td>
<td>通过其索引从列表获取元素</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://www.yiibai.com/redis/lists_linsert.html" target="_blank" rel="noopener">LINSERT key BEFORE/AFTER pivot value</a></td>
<td>在列表中的另一个元素之前或之后插入元素</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://www.yiibai.com/redis/lists_llen.html" target="_blank" rel="noopener">LLEN key</a></td>
<td>获取列表的长度</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://www.yiibai.com/redis/lists_lpop.html" target="_blank" rel="noopener">LPOP key</a></td>
<td>删除并获取列表中的第一个元素</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://www.yiibai.com/redis/lists_lpush.html" target="_blank" rel="noopener">LPUSH key value1 [value2]</a></td>
<td>将一个或多个值添加到列表</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://www.yiibai.com/redis/lists_lpushx.html" target="_blank" rel="noopener">LPUSHX key value</a></td>
<td>仅当列表存在时，才向列表添加值</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://www.yiibai.com/redis/lists_lrange.html" target="_blank" rel="noopener">LRANGE key start stop</a></td>
<td>从列表中获取一系列元素</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://www.yiibai.com/redis/lists_lrem.html" target="_blank" rel="noopener">LREM key count value</a></td>
<td>从列表中删除元素</td>
</tr>
<tr>
<td>12</td>
<td><a href="http://www.yiibai.com/redis/lists_lset.html" target="_blank" rel="noopener">LSET key index value</a></td>
<td>通过索引在列表中设置元素的值</td>
</tr>
<tr>
<td>13</td>
<td><a href="http://www.yiibai.com/redis/lists_ltrim.html" target="_blank" rel="noopener">LTRIM key start stop</a></td>
<td>修剪列表的指定范围</td>
</tr>
<tr>
<td>14</td>
<td><a href="http://www.yiibai.com/redis/lists_rpop.html" target="_blank" rel="noopener">RPOP key</a></td>
<td>删除并获取列表中的最后一个元素</td>
</tr>
<tr>
<td>15</td>
<td><a href="http://www.yiibai.com/redis/lists_rpoplpush.html" target="_blank" rel="noopener">RPOPLPUSH source destination</a></td>
<td>删除列表中的最后一个元素，将其附加到另一个列表并返回</td>
</tr>
<tr>
<td>16</td>
<td><a href="http://www.yiibai.com/redis/lists_rpush.html" target="_blank" rel="noopener">RPUSH key value1 [value2]</a></td>
<td>将一个或多个值附加到列表</td>
</tr>
<tr>
<td>17</td>
<td><a href="http://www.yiibai.com/redis/lists_rpushx.html" target="_blank" rel="noopener">RPUSHX key value</a></td>
<td>仅当列表存在时才将值附加到列表</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set：</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redisTemplate.opsForValue().getAndSet(key, value)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="http://www.yiibai.com/redis/sets_sadd.html" target="_blank" rel="noopener">SADD key member1 [member2]</a></td>
<td>将一个或多个成员添加到集合</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://www.yiibai.com/redis/sets_scard.html" target="_blank" rel="noopener">SCARD key</a></td>
<td>获取集合中的成员数</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://www.yiibai.com/redis/sets_sdiff.html" target="_blank" rel="noopener">SDIFF key1 [key2]</a></td>
<td>减去多个集合</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://www.yiibai.com/redis/sets_sdiffstore.html" target="_blank" rel="noopener">SDIFFSTORE destination key1 [key2]</a></td>
<td>减去多个集并将结果集存储在键中</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://www.yiibai.com/redis/sets_sinter.html" target="_blank" rel="noopener">SINTER key1 [key2]</a></td>
<td>相交多个集合</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://www.yiibai.com/redis/sets_sinterstore.html" target="_blank" rel="noopener">SINTERSTORE destination key1 [key2]</a></td>
<td>交叉多个集合并将结果集存储在键中</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://www.yiibai.com/redis/sets_sismember.html" target="_blank" rel="noopener">SISMEMBER key member</a></td>
<td>判断确定给定值是否是集合的成员</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://www.yiibai.com/redis/sets_smove.html" target="_blank" rel="noopener">SMOVE source destination member</a></td>
<td>将成员从一个集合移动到另一个集合</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://www.yiibai.com/redis/sets_spop.html" target="_blank" rel="noopener">SPOP key</a></td>
<td>从集合中删除并返回随机成员</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://www.yiibai.com/redis/sets_srandmember.html" target="_blank" rel="noopener">SRANDMEMBER key [count]</a></td>
<td>从集合中获取一个或多个随机成员</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://www.yiibai.com/redis/sets_srem.html" target="_blank" rel="noopener">SREM key member1 [member2]</a></td>
<td>从集合中删除一个或多个成员</td>
</tr>
<tr>
<td>12</td>
<td><a href="http://www.yiibai.com/redis/sets_sunion.html" target="_blank" rel="noopener">SUNION key1 [key2]</a></td>
<td>添加多个集合</td>
</tr>
<tr>
<td>13</td>
<td><a href="http://www.yiibai.com/redis/sets_sunionstore.html" target="_blank" rel="noopener">SUNIONSTORE destination key1 [key2]</a></td>
<td>添加多个集并将结果集存储在键中</td>
</tr>
<tr>
<td>14</td>
<td><a href="http://www.yiibai.com/redis/sets_sscan.html" target="_blank" rel="noopener">SSCAN key cursor [MATCH pattern] [COUNT count]</a></td>
<td>递增地迭代集合中的元素</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/02/27/encoding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/27/encoding/" itemprop="url">GBK、GB2312、iso-8859-1之间的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-27T16:32:47+08:00">
                2018-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址:<a href="http://blog.csdn.net/jerry_bj/article/details/5714745" target="_blank" rel="noopener">http://blog.csdn.net/jerry_bj/article/details/5714745</a></p>
<p>​    GB2312，由中华人民共和国政府制定的，简体汉字编码规范，大陆所有计算机中的简体中文，都使用此种编码格式。目前，我也不知道还有另外的简体汉字编码规范。与此对应的还有BIG5，是中华民国政府制定的，繁体汉字的编码规范，一般应用于海外计算机的繁体中文显示。所谓的繁体中文Windows，简体中文Windows，指的就是采用BIG5和GB2312编码格式的操作系统。这两种编码方式不兼容，如果使用一种编码的文本阅读器来读另一种编码的文本，就会出现乱码。比如在简体中文Windows上读BIG5编码的文件，就是乱码，反之亦然。使用简体浏览器浏览的时候，到了繁体中文网站，如果不改变码制，也是乱码。  </p>
<p>​           GBK，又称GBK大字符集，简而言之就是将所有亚洲文字的双字节字符，包括简体中文，繁体中文，日语，韩语等，都使用一种格式编码，这样就能够做到在所有的语言平台上面兼容。而且，目前GB2312，BIG5所包含的汉字数量也不足，比如我们总理的名字一般就打不出。而GBK大字符集包含的汉字数量比GB2312和BIG5多的多了。足够使用。   </p>
<p>​    ISO-8859-1，我了解的不太具体，好像在使用HTTP网络协议进行传输的时候，所有的信息都是按照ISO-8859-1编码方式进行编码的，浏览器默认的也是按照ISO-8859-1来解码。</p>
<pre><code>为了构成一个完整的对文字编码的认识和深入把握，以便处理在Java开发过程中遇到的各种问题，特别是乱码问题，我觉得组成一个系列来描述和分析更好一些，包括三篇文章：
</code></pre><p>第一篇：JAVA字符编码系列一：<a href="http://blog.csdn.net/qinysong/archive/2006/09/05/1179480.aspx" target="_blank" rel="noopener">Unicode,GBK,GB2312,UTF-8概念基础</a></p>
<p>第二篇：JAVA字符编码系列二：<a href="http://blog.csdn.net/qinysong/archive/2006/09/05/1179489.aspx" target="_blank" rel="noopener">Unicode,ISO-8859,GBK,UTF-8编码及相互转换</a></p>
<p>第三篇：JAVA字符编码系列三：<a href="http://blog.csdn.net/qinysong/archive/2006/09/05/1179513.aspx" target="_blank" rel="noopener">Java应用中的编码问题</a></p>
<p>第三篇：JAVA字符编码系列三：Java应用中的编码问题</p>
<p>这部分采用重用机制，引用一篇文章来完整本部分目标。</p>
<p>来源：   Eceel东西在线 问题研究–字符集编码</p>
<p>地址：<a href="http://china.eceel.com/article/study_for_character_encoding_java.htm" target="_blank" rel="noopener">http://china.eceel.com/article/study_for_character_encoding_java.htm</a></p>
<p>\1. 概述</p>
<p>本文主要包括以下几个方面：编码基本知识，java，系统软件，url，工具软件等。</p>
<p>在下面的描述中，将以”中文”两个字为例，经查表可以知道其GB2312编码是”d6d0 cec4”，Unicode编码为”4e2d 6587”，UTF编码就是”e4b8ad e69687”。注意，这两个字没有iso8859-1编码，但可以用iso8859-1编码来”表示”。</p>
<p>\2. 编码基本知识</p>
<p>最早的编码是iso8859-1，和ascii编码相似。但为了方便表示各种各样的语言，逐渐出现了很多标准编码，重要的有如下几个。</p>
<p>2.1. iso8859-1</p>
<p>属于单字节编码，最多能表示的字符范围是0-255，应用于英文系列。比如，字母’a’的编码为0x61=97。</p>
<p>很明显，iso8859-1编码表示的字符范围很窄，无法表示中文字符。但是，由于是单字节编码，和计算机最基础的表示单位一致，所以很多时候，仍旧使用iso8859-1编码来表示。而且在很多协议上，默认使用该编码。比如，虽然”中文”两个字不存在iso8859-1编码，以gb2312编码为例，应该是”d6d0 cec4”两个字符，使用iso8859-1编码的时候则将它拆开为4个字节来表示：”d6 d0 ce c4”（事实上，在进行存储的时候，也是以字节为单位处理的）。而如果是UTF编码，则是6个字节”e4 b8 ad e6 96 87”。很明显，这种表示方法还需要以另一种编码为基础。</p>
<p>2.2. GB2312/GBK</p>
<p>这就是汉子的国标码，专门用来表示汉字，是双字节编码，而英文字母和iso8859-1一致（兼容iso8859-1编码）。其中gbk编码能够用来同时表示繁体字和简体字，而gb2312只能表示简体字，gbk是兼容gb2312编码的。</p>
<p>2.3. unicode</p>
<p>这是最统一的编码，可以用来表示所有语言的字符，而且是定长双字节（也有四字节的）编码，包括英文字母在内。所以可以说它是不兼容iso8859-1编码的，也不兼容任何编码。不过，相对于iso8859-1编码来说，uniocode编码只是在前面增加了一个0字节，比如字母’a’为”00 61”。</p>
<p>需要说明的是，定长编码便于计算机处理（注意GB2312/GBK不是定长编码），而unicode又可以用来表示所有字符，所以在很多软件内部是使用unicode编码来处理的，比如java。</p>
<p>2.4. UTF</p>
<p>考虑到unicode编码不兼容iso8859-1编码，而且容易占用更多的空间：因为对于英文字母，unicode也需要两个字节来表示。所以unicode不便于传输和存储。因此而产生了utf编码，utf编码兼容iso8859-1编码，同时也可以用来表示所有语言的字符，不过，utf编码是不定长编码，每一个字符的长度从1-6个字节不等。另外，utf编码自带简单的校验功能。一般来讲，英文字母都是用一个字节表示，而汉字使用三个字节。</p>
<p>注意，虽然说utf是为了使用更少的空间而使用的，但那只是相对于unicode编码来说，如果已经知道是汉字，则使用GB2312/GBK无疑是最节省的。不过另一方面，值得说明的是，虽然utf编码对汉字使用3个字节，但即使对于汉字网页，utf编码也会比unicode编码节省，因为网页中包含了很多的英文字符。</p>
<p>\3. java对字符的处理</p>
<p>在java应用软件中，会有多处涉及到字符集编码，有些地方需要进行正确的设置，有些地方需要进行一定程度的处理。</p>
<p>3.1. getBytes(charset)</p>
<p>这是java字符串处理的一个标准函数，其作用是将字符串所表示的字符按照charset编码，并以字节方式表示。注意字符串在java内存中总是按unicode编码存储的。比如”中文”，正常情况下（即没有错误的时候）存储为”4e2d 6587”，如果charset为”gbk”，则被编码为”d6d0 cec4”，然后返回字节”d6 d0 ce c4”。如果charset为”utf8”则最后是”e4 b8 ad e6 96 87”。如果是”iso8859-1”，则由于无法编码，最后返回 “3f 3f”（两个问号）。</p>
<p>3.2. new String(charset)</p>
<p>这是java字符串处理的另一个标准函数，和上一个函数的作用相反，将字节数组按照charset编码进行组合识别，最后转换为unicode存储。参考上述getBytes的例子，”gbk” 和”utf8”都可以得出正确的结果”4e2d 6587”，但iso8859-1最后变成了”003f 003f”（两个问号）。</p>
<p>因为utf8可以用来表示/编码所有字符，所以new String( str.getBytes( “utf8” ), “utf8” ) === str，即完全可逆。</p>
<p>3.3. setCharacterEncoding()</p>
<p>该函数用来设置http请求或者相应的编码。</p>
<p>对于request，是指提交内容的编码，指定后可以通过getParameter()则直接获得正确的字符串，如果不指定，则默认使用iso8859-1编码，需要进一步处理。参见下述”表单输入”。值得注意的是在执行setCharacterEncoding()之前，不能执行任何getParameter()。java doc上说明：This method must be called prior to reading request parameters or reading input using getReader()。而且，该指定只对POST方法有效，对GET方法无效。分析原因，应该是在执行第一个getParameter()的时候，java将会按照编码分析所有的提交内容，而后续的getParameter()不再进行分析，所以setCharacterEncoding()无效。而对于GET方法提交表单是，提交的内容在URL中，一开始就已经按照编码分析所有的提交内容，setCharacterEncoding()自然就无效。</p>
<p>对于response，则是指定输出内容的编码，同时，该设置会传递给浏览器，告诉浏览器输出内容所采用的编码。</p>
<p>3.4. 处理过程</p>
<p>下面分析两个有代表性的例子，说明java对编码有关问题的处理方法。</p>
<p>3.4.1. 表单输入</p>
<p>User input <em>(gbk:d6d0 cec4) browser </em>(gbk:d6d0 cec4) web server iso8859-1(00d6 00d 000ce 00c4) class，需要在class中进行处理：getbytes(“iso8859-1”)为d6 d0 ce c4，new String(“gbk”)为d6d0 cec4，内存中以unicode编码则为4e2d 6587。</p>
<p>l 用户输入的编码方式和页面指定的编码有关，也和用户的操作系统有关，所以是不确定的，上例以gbk为例。</p>
<p>l 从browser到web server，可以在表单中指定提交内容时使用的字符集，否则会使用页面指定的编码。而如果在url中直接用?的方式输入参数，则其编码往往是操作系统本身的编码，因为这时和页面无关。上述仍旧以gbk编码为例。</p>
<p>l Web server接收到的是字节流，默认时（getParameter）会以iso8859-1编码处理之，结果是不正确的，所以需要进行处理。但如果预先设置了编码（通过request. setCharacterEncoding ()），则能够直接获取到正确的结果。</p>
<p>l 在页面中指定编码是个好习惯，否则可能失去控制，无法指定正确的编码。</p>
<p>3.4.2. 文件编译</p>
<p>假设文件是gbk编码保存的，而编译有两种编码选择：gbk或者iso8859-1，前者是中文windows的默认编码，后者是linux的默认编码，当然也可以在编译时指定编码。</p>
<p>Jsp <em>(gbk:d6d0 cec4) java file </em>(gbk:d6d0 cec4) compiler read uincode(gbk: 4e2d 6587; iso8859-1: 00d6 00d 000ce 00c4) compiler write utf(gbk: e4b8ad e69687; iso8859-1: *) compiled file unicode(gbk: 4e2d 6587; iso8859-1: 00d6 00d 000ce 00c4) class。所以用gbk编码保存，而用iso8859-1编译的结果是不正确的。</p>
<p>class unicode(4e2d 6587) system.out / jsp.out gbk(d6d0 cec4) os console / browser。</p>
<p>l 文件可以以多种编码方式保存，中文windows下，默认为ansi/gbk。</p>
<p>l 编译器读取文件时，需要得到文件的编码，如果未指定，则使用系统默认编码。一般class文件，是以系统默认编码保存的，所以编译不会出问题，但对于jsp文件，如果在中文windows下编辑保存，而部署在英文linux下运行/编译，则会出现问题。所以需要在jsp文件中用pageEncoding指定编码。</p>
<p>l Java编译的时候会转换成统一的unicode编码处理，最后保存的时候再转换为utf编码。</p>
<p>l 当系统输出字符的时候，会按指定编码输出，对于中文windows下，System.out将使用gbk编码，而对于response（浏览器），则使用jsp文件头指定的contentType，或者可以直接为response指定编码。同时，会告诉browser网页的编码。如果未指定，则会使用iso8859-1编码。对于中文，应该为browser指定输出字符串的编码。</p>
<p>l browser显示网页的时候，首先使用response中指定的编码（jsp文件头指定的contentType最终也反映在response上），如果未指定，则会使用网页中meta项指定中的contentType。</p>
<p>3.5. 几处设置</p>
<p>对于web应用程序，和编码有关的设置或者函数如下。</p>
<p>3.5.1. jsp编译</p>
<p>指定文件的存储编码，很明显，该设置应该置于文件的开头。例如：&lt;%@page pageEncoding=”GBK”%&gt;。另外，对于一般class文件，可以在编译的时候指定编码。</p>
<p>3.5.2. jsp输出</p>
<p>指定文件输出到browser是使用的编码，该设置也应该置于文件的开头。例如：&lt;%@ page contentType=”text/html; charset= GBK” %&gt;。该设置和response.setCharacterEncoding(“GBK”)等效。</p>
<p>3.5.3. meta设置</p>
<p>指定网页使用的编码，该设置对静态网页尤其有作用。因为静态网页无法采用jsp的设置，而且也无法执行response.setCharacterEncoding()。例如：<meta http-equiv="Content-Type" content="text/html; charset=GBK"></p>
<p>如果同时采用了jsp输出和meta设置两种编码指定方式，则jsp指定的优先。因为jsp指定的直接体现在response中。</p>
<p>需要注意的是，apache有一个设置可以给无编码指定的网页指定编码，该指定等同于jsp的编码指定方式，所以会覆盖静态网页中的meta指定。所以有人建议关闭该设置。</p>
<p>3.5.4. form设置</p>
<p>当浏览器提交表单的时候，可以指定相应的编码。例如：<form accept-charset="gb2312">。一般不必不使用该设置，浏览器会直接使用网页的编码。</form></p>
<p>\4. 系统软件</p>
<p>下面讨论几个相关的系统软件。</p>
<p>4.1. mysql数据库</p>
<p>很明显，要支持多语言，应该将数据库的编码设置成utf或者unicode，而utf更适合与存储。但是，如果中文数据中包含的英文字母很少，其实unicode更为适合。</p>
<p>数据库的编码可以通过mysql的配置文件设置，例如default-character-set=utf8。还可以在数据库链接URL中设置，例如： useUnicode=true&amp;characterEncoding=UTF-8。注意这两者应该保持一致，在新的sql版本里，在数据库链接URL里可以不进行设置，但也不能是错误的设置。</p>
<p>4.2. apache</p>
<p>appache和编码有关的配置在httpd.conf中，例如AddDefaultCharset UTF-8。如前所述，该功能会将所有静态页面的编码设置为UTF-8，最好关闭该功能。</p>
<p>另外，apache还有单独的模块来处理网页响应头，其中也可能对编码进行设置。</p>
<p>4.3. linux默认编码</p>
<p>这里所说的linux默认编码，是指运行时的环境变量。两个重要的环境变量是LC_ALL和LANG，默认编码会影响到java URLEncode的行为，下面有描述。</p>
<p>建议都设置为”zh_CN.UTF-8”。</p>
<p>4.4. 其它</p>
<p>为了支持中文文件名，linux在加载磁盘时应该指定字符集，例如：mount /dev/hda5 /mnt/hda5/ -t ntfs -o iocharset=gb2312。</p>
<p>另外，如前所述，使用GET方法提交的信息不支持request.setCharacterEncoding()，但可以通过tomcat的配置文件指定字符集，在tomcat的server.xml文件中，形如：<connector ...="" uriencoding="GBK">。这种方法将统一设置所有请求，而不能针对具体页面进行设置，也不一定和browser使用的编码相同，所以有时候并不是所期望的。</connector></p>
<p>\5. URL地址</p>
<p>URL地址中含有中文字符是很麻烦的，前面描述过使用GET方法提交表单的情况，使用GET方法时，参数就是包含在URL中。</p>
<p>5.1. URL编码</p>
<p>对于URL中的一些特殊字符，浏览器会自动进行编码。这些字符除了”/?&amp;”等外，还包括unicode字符，比如汉子。这时的编码比较特殊。</p>
<p>IE有一个选项”总是使用UTF-8发送URL”，当该选项有效时，IE将会对特殊字符进行UTF-8编码，同时进行URL编码。如果改选项无效，则使用默认编码”GBK”，并且不进行URL编码。但是，对于URL后面的参数，则总是不进行编码，相当于UTF-8选项无效。比如”中文.html?a=中文”，当UTF-8选项有效时，将发送链接”%e4%b8%ad%e6%96%87.html?a=/x4e/x2d/x65/x87”；而UTF-8选项无效时，将发送链接”/x4e/x2d/x65/x87.html?a=/x4e/x2d/x65/x87”。注意后者前面的”中文”两个字只有4个字节，而前者却有18个字节，这主要时URL编码的原因。</p>
<p>当web server（tomcat）接收到该链接时，将会进行URL解码，即去掉”%”，同时按照ISO8859-1编码（上面已经描述，可以使用URLEncoding来设置成其它编码）识别。上述例子的结果分别是”/ue4/ub8/uad/ue6/u96/u87.html?a=/u4e/u2d/u65/u87”和”/u4e/u2d/u65/u87.html?a=/u4e/u2d/u65/u87”，注意前者前面的”中文”两个字恢复成了6个字符。这里用”/u”，表示是unicode。</p>
<p>所以，由于客户端设置的不同，相同的链接，在服务器上得到了不同结果。这个问题不少人都遇到，却没有很好的解决办法。所以有的网站会建议用户尝试关闭UTF-8选项。不过，下面会描述一个更好的处理办法。</p>
<p>5.2. rewrite</p>
<p>熟悉的人都知道，apache有一个功能强大的rewrite模块，这里不描述其功能。需要说明的是该模块会自动将URL解码（去除%），即完成上述web server（tomcat）的部分功能。有相关文档介绍说可以使用[NE]参数来关闭该功能，但我试验并未成功，可能是因为版本（我使用的是apache 2.0.54）问题。另外，当参数中含有”?&amp; “等符号的时候，该功能将导致系统得不到正常结果。</p>
<p>rewrite本身似乎完全是采用字节处理的方式，而不考虑字符串的编码，所以不会带来编码问题。</p>
<p>5.3. URLEncode.encode()</p>
<p>这是Java本身提供对的URL编码函数，完成的工作和上述UTF-8选项有效时浏览器所做的工作相似。值得说明的是，java已经不赞成不指定编码来使用该方法（deprecated）。应该在使用的时候增加编码指定。</p>
<p>当不指定编码的时候，该方法使用系统默认编码，这会导致软件运行结果得不确定。比如对于”中文”，当系统默认编码为”gb2312”时，结果是”%4e%2d%65%87”，而默认编码为”UTF-8”，结果却是”%e4%b8%ad%e6%96%87”，后续程序将难以处理。另外，这儿说的系统默认编码是由运行tomcat时的环境变量LC_ALL和LANG等决定的，曾经出现过tomcat重启后就出现乱码的问题，最后才郁闷的发现是因为修改修改了这两个环境变量。</p>
<p>建议统一指定为”UTF-8”编码，可能需要修改相应的程序。</p>
<p>\6. 其它</p>
<p>下面描述一些和编码有关的其他问题。</p>
<p>6.1. SecureCRT</p>
<p>除了浏览器和控制台与编码有关外，一些客户端也很有关系。比如在使用SecureCRT连接linux时，应该让SecureCRT的显示编码（不同的session，可以有不同的编码设置）和linux的编码环境变量保持一致。否则看到的一些帮助信息，就可能是乱码。</p>
<p>另外，mysql有自己的编码设置，也应该保持和SecureCRT的显示编码一致。否则通过SecureCRT执行sql语句的时候，可能无法处理中文字符，查询结果也会出现乱码。</p>
<p>对于Utf-8文件，很多编辑器（比如记事本）会在文件开头增加三个不可见的标志字节，如果作为mysql的输入文件，则必须要去掉这三个字符。（用linux的vi保存可以去掉这三个字符）。一个有趣的现象是，在中文windows下，创建一个新txt文件，用记事本打开，输入”连通”两个字，保存，再打开，你会发现两个字没了，只留下一个小黑点。</p>
<p>6.2. 过滤器</p>
<p>如果需要统一设置编码，则通过filter进行设置是个不错的选择。在filter class中，可以统一为需要的请求或者回应设置编码。参加上述setCharacterEncoding()。这个类apache已经给出了可以直接使用的例子SetCharacterEncodingFilter。</p>
<p>6.3. POST和GET</p>
<p>很明显，以POST提交信息时，URL有更好的可读性，而且可以方便的使用setCharacterEncoding()来处理字符集问题。但GET方法形成的URL能够更容易表达网页的实际内容，也能够用于收藏。</p>
<p>从统一的角度考虑问题，建议采用GET方法，这要求在程序中获得参数是进行特殊处理，而无法使用setCharacterEncoding()的便利，如果不考虑rewrite，就不存在IE的UTF-8问题，可以考虑通过设置URIEncoding来方便获取URL中的参数。</p>
<p>6.4. 简繁体编码转换</p>
<p>GBK同时包含简体和繁体编码，也就是说同一个字，由于编码不同，在GBK编码下属于两个字。有时候，为了正确取得完整的结果，应该将繁体和简体进行统一。可以考虑将UTF、GBK中的所有繁体字，转换为相应的简体字，BIG5编码的数据，也应该转化成相应的简体字。当然，仍旧以UTF编码存储。</p>
<p>例如，对于”语言 語言”，用UTF表示为”/xE8/xAF/xAD/xE8/xA8/x80 /xE8/xAA/x9E/xE8/xA8/x80”，进行简繁体编码转换后应该是两个相同的 “/xE8/xAF/xAD/xE8/xA8/x80&gt;”。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/02/25/maven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/25/maven/" itemprop="url">maven的聚合和继承</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-25T15:59:32+08:00">
                2018-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考:<a href="https://www.cnblogs.com/youzhibing/p/5427130.html" target="_blank" rel="noopener">https://www.cnblogs.com/youzhibing/p/5427130.html</a></p>
<h5 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h5><p>继承是 Maven 中很强大的一种功能，继承可以使得子POM可以获得 parent 中的各项配置，可以对子pom进行统一的配置和依赖管理。父POM中的大多数元素都能被子POM继承</p>
<p>1.在Maven中dependencyManagement的作用其实相当于一个对所依赖jar包进行版本管理的管理器</p>
<p>2.pom.xml文件中，jar的版本判断的两种途径</p>
<p>1：如果dependencies里的dependency自己没有声明version元素，那么maven就</p>
<p>会倒dependencyManagement里面去找有没有对该artifactId和groupId进行过版本声明，如果有，就继承它，如果</p>
<p>没有就会报错，告诉你必须为dependency声明一个version</p>
<p>2：如果dependencies中的dependency声明了version，那么无论dependencyManagement中有无对该jar的version声明，都以dependency里的version为准。</p>
<h5 id="聚合（或多模块）"><a href="#聚合（或多模块）" class="headerlink" title="聚合（或多模块）"></a>聚合（或多模块）</h5><p>具有模块的项目被称为多模块或聚合项目。模块是此POM列出并作为一组执行的项目。通过一个pom打包的项目可以将它们列为模块来聚合成一组项目进行构建，这些模块名是这些项目的相对目录。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/01/31/elasticsearch-develop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/31/elasticsearch-develop/" itemprop="url">Elasticsearch 相关开发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-31T03:31:29+08:00">
                2018-01-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开发Elasticsearch项目首先需要搭建Elasticsearch服务，具体搭建详见《Elasticsearch安装运行篇》</p>
<p>安装kibana，目的是为了通过它创建索引和Mapping</p>
<p>首先是查看当前elasticsearch的索引</p>
<p>GET _all</p>
<p><img src="/2018/01/31/elasticsearch-develop/ab34c966-81c4-421a-affb-29024b8a4041.png" alt="img"> 然后通过 PUT /timeline 来创建索引</p>
<p>创建成功后，再创建类型（Mapping） </p>
<p>通过POST /timeline/record/_mapping</p>
<p><img src="/2018/01/31/elasticsearch-develop/79cf5f34-ff75-4baf-a39a-2039b08fcb71.png" alt="img"> 同时设置不允许于类型不同的数据提交时修改类型</p>
<p>如果需要修改类型，只能新增，但不能删除和修改已存在的属性。修改方式和创建类型方式一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Post /timeline/record/_mapping</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">POST /timeline/record/_mapping</span><br><span class="line">&#123;</span><br><span class="line">    &quot;record&quot;: &#123;</span><br><span class="line">        &quot;dynamic&quot;: &quot;false&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">            &quot;lzbh&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;sjm&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;sj&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;date&quot;,</span><br><span class="line">                &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;lylx&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;title&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;content&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;czrjh&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;czrxm&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;lyh&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;bs&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;bscode&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;czcode&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;xqdz&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;xxczcode&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;fqdw&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;fqdwm&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;fqdws&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;fqdwms&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;mddws&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;mddwms&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;dw&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">                &quot;properties&quot;: &#123;</span><br><span class="line">                    &quot;jd&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;double&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;wd&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;double&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;dwczcode&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;ypfj&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">                &quot;dynamic&quot;: &quot;false&quot;,</span><br><span class="line">                &quot;properties&quot;: &#123;</span><br><span class="line">                    &quot;extension&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;fileurl&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;filename&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                        &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;spfj&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">                &quot;dynamic&quot;: &quot;false&quot;,</span><br><span class="line">                &quot;properties&quot;: &#123;</span><br><span class="line">                    &quot;extension&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;fileurl&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;filename&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                        &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;tpfj&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">                &quot;dynamic&quot;: &quot;false&quot;,</span><br><span class="line">                &quot;properties&quot;: &#123;</span><br><span class="line">                    &quot;extension&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;fileurl&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;filename&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                        &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;wjfj&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">                &quot;dynamic&quot;: &quot;false&quot;,</span><br><span class="line">                &quot;properties&quot;: &#123;</span><br><span class="line">                    &quot;extension&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;keyword&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;fileurl&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;filename&quot;: &#123;</span><br><span class="line">                        &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                        &quot;analyzer&quot;: &quot;ik_max_word&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>搜索数据通过方法：</p>
<p>先查加上size可以获得总记录数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /relatedunits1/units/_search</span><br><span class="line">&#123;</span><br><span class="line">	&quot;size&quot;: &quot;0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Java代码使用的组件接口可以选,具体如下，代码里使用的是spring.data里包含的elasticsearch客户端组件。下面是elastic官方提供的组件。如果需要最新版本的elasticsearch则需要使用官方组件，同时还需要注意分词器对应的版本是否支持。</p>
<p><img src="/2018/01/31/elasticsearch-develop/5bcf5a16-a394-4997-aa0d-ecc6dd19940b.png" alt="img"></p>
<p>可以通过maven来下载对应版本的组件</p>
<p><img src="/2018/01/31/elasticsearch-develop/7a8ac7a1-2352-4db3-8b69-97c0f3ba04fd.png" alt="img"></p>
<p>相关分词组件</p>
<p>如IK中文分词器可以到<a href="https://github.com/medcl/elasticsearch-analysis-ik" target="_blank" rel="noopener">https://github.com/medcl/elasticsearch-analysis-ik</a>去下载</p>
<p>进入release目录查看已经发布的版本</p>
<p><img src="/2018/01/31/elasticsearch-develop/a6025996-2128-4e00-97c8-78c0aeb7622d.png" alt="img"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/01/12/classpath/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/12/classpath/" itemprop="url">.classpath作用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-12T15:30:38+08:00">
                2018-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="eclipse中的-project-和-classpath文件的具体作用是什么？"><a href="#eclipse中的-project-和-classpath文件的具体作用是什么？" class="headerlink" title="eclipse中的.project 和 .classpath文件的具体作用是什么？"></a>eclipse中的.project 和 .classpath文件的具体作用是什么？</h2><p>.project是项目文件，项目的结构都在其中定义，比如lib的位置,src的位置,classes的位置<br>.classpath的位置定义了你这个项目在编译时所使用的$CLASSPATH<br>这些文件你用文本编辑器就能察看了</p>
<p>在一个项目中点刷新的目的是为了更新.project文件中的文件清单，让你把不通过eclipse提交到项目的文件显示出来</p>
<p><strong>.classpath 文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">classpath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"src"</span> <span class="attr">path</span>=<span class="string">"src"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"src"</span> <span class="attr">path</span>=<span class="string">"test"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"con"</span> <span class="attr">path</span>=<span class="string">"org.eclipse.jdt.launching.JRE_CONTAINER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"con"</span> <span class="attr">path</span>=<span class="string">"org.eclipse.jdt.junit.JUNIT_CONTAINER/4"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"lib"</span> <span class="attr">path</span>=<span class="string">"lib/dom4j-1.6.1.jar"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">attributes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">"javadoc_location"</span> <span class="attr">value</span>=<span class="string">"file:/home/wpc/Work/Apache/dom4j-1.6.1/docs/api"</span>&gt;</span><span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">classpathentry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">classpathentry</span> <span class="attr">kind</span>=<span class="string">"output"</span> <span class="attr">path</span>=<span class="string">"bin"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">classpath</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  从数据上我们容易看出，上面描述了工程的依赖文件：</p>
<ol>
<li>源文件的具体位置（kind=”src”）</li>
<li>运行的系统环境（kind=”con”）</li>
<li>工程的library的具体位置信息(kind=”lib”)</li>
<li>在每个lib的xml子节点中，有关于它的其它配置信息（例如我配置的那个”javadoc_location”）</li>
<li>项目的输出目录(kind=”output”)</li>
</ol>
<p><img src="http://www.javaeye.com/upload/attachment/43812/2fcecc0b-e301-3756-82d0-ab18a43df76b.png" alt="img"></p>
<p>总体上说这个文件就是配置整个工程的运行环境。</p>
<p><strong>.project 文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">projectDescription</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>CreateInterpret<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">comment</span>&gt;</span>JavaCC Nature@key 32303037303632392D3130303020437265617465496E746572707265742F777063 <span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">projects</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">projects</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">buildSpec</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">buildCommand</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>sf.eclipse.javacc.javaccbuilder<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">buildCommand</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">buildCommand</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>org.eclipse.jdt.core.javabuilder<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">buildCommand</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">buildSpec</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">natures</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">nature</span>&gt;</span>org.eclipse.jdt.core.javanature<span class="tag">&lt;/<span class="name">nature</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">nature</span>&gt;</span>sf.eclipse.javacc.javaccnature<span class="tag">&lt;/<span class="name">nature</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">natures</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">projectDescription</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​      </p>
<p> 从数据上看，我们可以了解到这些配置主要是描述工程的基本信息：</p>
<ol>
<li>工程名<name></name></li>
<li>工程注释描述<comment></comment></li>
<li>运行时需要的额外Eclipse插件<natures></natures>，及其具体加载方式信息<buildspec></buildspec></li>
</ol>
<p>如果你在开发过程中向工程里面加入了很多额外的插件，则必然会导致你的Eclipse启动速度变慢。在这种情况下，你可以到这个文件里面去掉一些插件，不过这样一来你在开启那些关联文件的时候会加载那些插件。</p>
<p><strong>.settings 文件</strong></p>
<p>​     里面存放各种插件的配置文件。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/01/12/typescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/12/typescript/" itemprop="url">typescript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-12T13:25:11+08:00">
                2018-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web前端/" itemprop="url" rel="index">
                    <span itemprop="name">web前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1 安装Visual Studio Code <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">https://code.visualstudio.com/</a></p>
<p>2 安装typescript</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g typescript</span><br></pre></td></tr></table></figure>
<p>更新并查看版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm update -g typescript</span><br><span class="line">tsc -v</span><br></pre></td></tr></table></figure>
<p>3 安装typings</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g typings</span><br></pre></td></tr></table></figure>
<p>4 安装 node 的 .d.ts 库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @types/node --dev-save</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/01/04/document/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/04/document/" itemprop="url">概要设计与详细设计区分</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-04T16:21:36+08:00">
                2018-01-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h5><p>​    概要设计就是设计软件的结构，包括组成模块，模块的层次结构，模块的调用关系，每个模块的功能等等。同时，还要设计该项目的应用系统的总体数据结构和数据库结构，即应用系统要存储什么数据，这些数据是什么样的结构，它们之间有什么关系。<br>​    详细设计阶段就是为每个模块完成的功能进行具体的描述，要把功能描述转变为精确的、结构化的过程描述。<br>​    概要设计阶段通常得到软件结构图<br>​    详细设计阶段常用的描述方式有：流程图、N-S图、PAD图、伪代码等<br><strong>概要设计和详细设计</strong></p>
<p>​    在软件设计中，大家经常问到的一个问题是：概要设计应该怎样一个概要法，详细设计应该怎样一个详细法？<br>这个问题在公司内部经常有人问。现在陈述一下。<br>​    我们公司的研发流程是瀑布型的，这个模型中的分析、设计阶段是基于经典的结构化方法。<br>​    结构化设计方法的基本思路是：按照问题域，将软件逐级细化，分解为不必再分解的的模块，每个模块完成一定的功能，为一个或多个父模块服务（即接受调用），也接受一个或多个子模块的服务（即调用子模块）。模块的概念，和编程语言中的子程序或函数是对应的。<br>   这样一来，设计可以明显地划分成两个阶段：<br>​    概要（结构）设计阶段：把软件按照一定的原则分解为模块层次，赋予每个模块一定的任务，并确定模块间调用关系和接口。<br>​    详细设计阶段：依据概要设计阶段的分解，设计每个模块内的算法、流程等。<br>概要设计阶段：<br>​    在 这个阶段，设计者会大致考虑并照顾模块的内部实现，但不过多纠缠于此。主要集中于划分模块、分配任务、定义调用关系。模块间的接口与传参在这个阶段要定得 十分细致明确，应编写严谨的数据字典，避免后续设计产生不解或误解。概要设计一般不是一次就能做到位，而是反复地进行结构调整。典型的调整是合并功能重复 的模块，或者进一步分解出可以复用的模块。在概要设计阶段，应最大限度地提取可以重用的模块，建立合理的结构体系，节省后续环节的工作量。<br>​    概要设计文档最重要的部分是分层数据流图、结构图、数据字典以及相应的文字说明等。以概要设计文档为依据，各个模块的详细设计就可以并行展开了。<br>详细设计阶段:<br>​    在 这个阶段，各个模块可以分给不同的人去并行设计。在详细设计阶段，设计者的工作对象是一个模块，根据概要设计赋予的局部任务和对外接口，设计并表达出模块 的算法、流程、状态转换等内容。这里要注意，如果发现有结构调整（如分解出子模块等）的必要，必须返回到概要设计阶段，将调整反应到概要设计文档中，而不 能就地解决，不打招呼。详细设计文档最重要的部分是模块的流程图、状态图、局部变量及相应的文字说明等。一个模块一篇详细设计文档。<br>​    概要设计文档相当于机械设计中的装配图，而详细设计文档相当于机械设计中的零件图。文档的编排、装订方式也可以参考机械图纸的方法。<br>​    我们公司对模块的认识和传统定义有所不同，认为是较大的软件功能单元才可以称作模块。这种认识使大家对概要设计和详细设计的分工产生了混乱的理解，降低了文档的可用性，应该予以纠正。<br>​    概要设计中较顶层的部分便是所谓的方案。方案文档的作用是在宏观的角度上保持设计的合理性。<br>​    有 的项目采用面向对象的分析、设计方法。可能在概要设计、详细设计的分工上疑问更多。其实，面向对象的分析、设计方法并没有强调结构化方法那样的阶段性，因 此一般不引入概要、详细设计的概念。如果按照公司的文档体系，非要有这种分工的话，可以将包的划分、类及对象间的关系、类的对外属性、方法及协作设计看做 概要设计；类属性、方法的内部实现看做详细设计。<br>   1.需求分析–产生软件功能规格说明书,需要确定用户对软件的需求,要作到明确、无歧义。不涉及具体实现方法。用户能看得明白，开发人员也可据此进行下面的工作（概要设计）。<br>   2.概要设计–产生软件概要设计说明书，说明系统模块划分、选择的技术路线等，整体说明软件的实现思路。并且需要指出关键技术难点等。<br>   3.详细设计–产生软件详细设计说明书，对概要设计的进一步细化，一般由各部分的担当人员依据概要设计分别完成，然后在集成，是具体的实现细节。理论上要求可以照此编码。<br><strong>概要设计和详细设计的区别与联系</strong></p>
<p>​    软件设计采用自顶向下、逐次功能展开的设计方法，首先完成总体设计，然后完成各有机组成部分的设计。<br>​    根据工作性质和内容的不同，软件设计分为概要设计和详细设计。概要设计实现软件的总体设计、模块划分、用户界面设计、数据库设计等等；详细设计则根据概要设计所做的模块划分，实现各模块的算法设计，实现用户界面设计、数据结构设计的细化，等等。<br>​    概要设计是详细设计的基础，必须在详细设计之前完成，概要设计经复查确认后才可以开始详细设计。概要设计，必须完成概要设计文档，包括系统的总体设计文档、以及各个模块的概要设计文档。每个模块的设计文档都应该独立成册。<br>​    详细设计必须遵循概要设计来进行。详细设计方案的更改，不得影响到概要设计方案；如果需要更改概要设计，必须经过项目经理的同意。详细设计，应该完成详细设计文档，主要是模块的详细设计方案说明。和概要设计一样，每个模块的详细设计文档都应该独立成册。<br>   概要设计里面的数据库设计应该重点在描述数据关系上，说明数据的来龙去脉，在这里应该结合我们的一下结果数据，说明这些结果数据的源点，我们这样设计的目 的和原因。详细设计里的数据库设计就应该是一份完善的数据结构文档，就是一个包括类型、命名、精度、字段说明、表说明等内容的数据字典。<br>   概要设计里的功能应该是重点在功能描述，对需求的解释和整合，整体划分功能模块，并对各功能模块进行详细的图文描述，应该让读者大致了解系统作完后大体的 结构和操作模式。详细设计则是重点在描述系统的实现方式，各模块详细说明实现功能所需的类及具体的方法函数，包括涉及到的sql语句等。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hujao.com/2018/01/01/jmeter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ace1981">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ace'pages">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/01/jmeter/" itemprop="url">jmeter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-01T22:57:55+08:00">
                2018-01-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/yan-li/" itemprop="url" rel="index">
                    <span itemprop="name">yan'li</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ace1981</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">128</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index/index.html">
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ace1981</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
